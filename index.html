<html>
<head>
	<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="raphael-min.js"></script>
	<script src="./cloud.js"></script>
	<style type="text/css">
		body {
			padding: 0;
			margin: 0;
		}
		span{
			display:block;
			font-size:1em;
			position:absolute;
		}
		.circle {
			border:1px solid orange;
			width:100%;
			height:100%;
			border-radius:50%;
			display:block;
			top:0;
			left:0;
		}
	</style>
	<script>

		var stokeColor = 'orange';

		function init() {
			var w = document.body.clientWidth, h = document.body.clientHeight;
			var clouder = document.getElementById('cloud');
			clouder.style.width = 500;
			clouder.style.height = 500;
			clouder.style.position = "absolute";
			clouder.style.left = 0;
			clouder.style.top = 0;
			clouder.style.border = "1px solid #999";
			window.clouder = new Clouder({
				container:cloud,
				tags:circles
			});
		} // init
		var elems = [];
		function createTags() {
			elems.push({text:"Az", id:"1", weight:1});
			elems.push({text:"Vedi", id:"2", weight:1});
			elems.push({text:"Glagol", id:"3", weight:1});
			elems.push({text:"Dobro", id:"4", weight:1});
			elems.push({text:"Est", id:"5", weight:1});
			elems.push({text:"Zelo", id:"6", weight:1});
			return elems;
		} // createTa

		/**
		 * Paths
		 */
		// Create path
		var paths = new Array();
		function createPaths() {
			console.log('Create Paths ======================');
			for (i = 0; i < circles.length; i++) {
				paths[i] = new Array();
				for (j = 0; j < circles.length; j++) {
					if (circles[i].id !== circles[j].id) {
						paths[i] = stage.path('M10,20L30,40');
						paths[i].attr("stroke-width", 0.2);
						paths[i].attr("stroke", stokeColor);
						paths[i].node.id = 'p_' + paths[i].id;
					}
				}
			}
		}

		// Update path coordinates
		function udpatePaths() {
			console.log('Udpate Paths ======================');
			var circleA,
				circleB,
				circleAposX,
				circleAposY,
				circleBposX,
				circleBposY,
				secondCircleId,
				pathId,
				path;
			for (i = 0; i < circles.length; i++) {
				//console.log(i);
				circleA = stage.getById(i);
				circleAposX = circleA.attrs.cx;
				circleAposY = circleA.attrs.cy;
				secondCircleId = i;
				for (j = i; j < (i + circles.length - 1); j++) {
					//circle
				   if(j == (circles.length -1)){
					   secondCircleId = 0;
				   }  else{
					   secondCircleId++;
				   }
					circleB = stage.getById(secondCircleId);
					circleBposX = circleB.attrs.cx;
					circleBposY = circleB.attrs.cy;

					//path
					pathId = j + ((circles.length - 2) * i) + circles.length;
					path = stage.getById(pathId);
					$('#p_' + path.id).attr('d', 'M' + circleAposX + ' '  + circleAposY + ' L' + circleBposX + ' ' + circleBposY);
				}
			}
		}

		/*
		* Circles
		 */
		var circles = new Array();
		function createCircles() {
			console.log('Create Circles ======================');
			var c;
			for (i = 0; i < elems.length; i++) {
				circles[i] = stage.circle(0, 0, 10);
				circles[i].attr('stroke', 'orange');
				circles[i].node.id = 'c_' + circles[i].id;
			}
		}

		function updateCircle(o){
			console.log('Update Circle ======================');
			var elm = stage.getById(o.id);
			elm.attrs.cx = o.screenX;
			elm.attrs.cy = o.screenY;
			elm.animate({cx:elm.attrs.cx, cy:elm.attrs.cy});
			//console.log(elm.attrs.cx);
			//$('#c_' + o.id).attr('cx', o.screenX);
			//$('#c_' + o.id).attr('cY', o.screenY);
			//udpatePaths(o);
			//elm.glow({ color: "orange", width: 5, opacity:1, offsetx: o.screenX, offsety: o.screenY});
		}

		/**
		 * Texts
		 */
		function createTexts() {
			var t;
			for (i = 0; i < elems.length; i++) {
				t = stage.text();
				t .node.id = 't_' + elems[i].text;
				t.attr('text', elems[i].text);
			}
		}

		function updateText(elem) {
			var elemId = elem.text;
			$('#t_' + elemId).attr('x', elem.screenX);
			$('#t_' + elemId).attr('y', elem.screenY);
		}

		/**
		 * Update elements position
		 */
		function updateTagsPositions(elem) {
			var elemId = elem.id - 1;
			/*elems[elemId].x = elem.screenX;
			elems[elemId].y = elem.screenY;   */
		}

		var stage;
		$(function () {
			stage = Raphael(0, 0, 500, 500);
			createTags();
			createCircles();
			createPaths();
			//createTexts();
			init();
		});
	</script>
</head>
<body>

<div id="cloud"></div>
</body>
</html>

